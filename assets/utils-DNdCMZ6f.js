import{q as F,s as B,t as V,v as j,U as q,w as J,x as Y,y as Z,S as Q}from"./vendor-xBiLovak.js";const me=()=>{let e=!1;if("maxTouchPoints"in navigator)e=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)e=navigator.msMaxTouchPoints>0;else{const t=matchMedia==null?void 0:matchMedia("(pointer:coarse)");if((t==null?void 0:t.media)==="(pointer:coarse)")e=!!t.matches;else if("orientation"in window)e=!0;else{const i=navigator.userAgent;e=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(i)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(i)}}return e};function ve(e,t=1e-4){t=Math.max(t,Number.EPSILON);const i={},a=e.getIndex(),r=e.getAttribute("position"),s=a?a.count:r.count;let o=0;const u=Object.keys(e.attributes),f={},n={},c=[],d=["getX","getY","getZ","getW"];for(let g=0,w=u.length;g<w;g++){const p=u[g];f[p]=[];const h=e.morphAttributes[p];h&&(n[p]=new Array(h.length).fill(0).map(()=>[]))}const l=Math.log10(1/t),v=Math.pow(10,l);for(let g=0;g<s;g++){const w=a?a.getX(g):g;let p="";for(let h=0,A=u.length;h<A;h++){const _=u[h],b=e.getAttribute(_),M=b.itemSize;for(let D=0;D<M;D++)p+=`${~~(b[d[D]](w)*v)},`}if(p in i)c.push(i[p]);else{for(let h=0,A=u.length;h<A;h++){const _=u[h],b=e.getAttribute(_),M=e.morphAttributes[_],D=b.itemSize,P=f[_],X=n[_];for(let I=0;I<D;I++){const C=d[I];if(P.push(b[C](w)),M)for(let y=0,z=M.length;y<z;y++)X[y].push(M[y][C](w))}}i[p]=o,c.push(o),o++}}const T=e.clone();for(let g=0,w=u.length;g<w;g++){const p=u[g],h=e.getAttribute(p),A=new h.array.constructor(f[p]),_=new j(A,h.itemSize,h.normalized);if(T.setAttribute(p,_),p in n)for(let b=0;b<n[p].length;b++){const M=e.morphAttributes[p][b],D=new M.array.constructor(n[p][b]),P=new j(D,M.itemSize,M.normalized);T.morphAttributes[p][b]=P}}return T.setIndex(c),T}function he(e,t){if(t===F)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===B||t===V){let i=e.getIndex();if(i===null){const o=[],u=e.getAttribute("position");if(u!==void 0){for(let f=0;f<u.count;f++)o.push(f);e.setIndex(o),i=e.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e}const a=i.count-2,r=[];if(i)if(t===B)for(let o=1;o<=a;o++)r.push(i.getX(0)),r.push(i.getX(o)),r.push(i.getX(o+1));else for(let o=0;o<a;o++)o%2===0?(r.push(i.getX(o)),r.push(i.getX(o+1)),r.push(i.getX(o+2))):(r.push(i.getX(o+2)),r.push(i.getX(o+1)),r.push(i.getX(o)));r.length/3!==a&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=e.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}function ee(){var e=Object.create(null);function t(r,s){var o=r.id,u=r.name,f=r.dependencies;f===void 0&&(f=[]);var n=r.init;n===void 0&&(n=function(){});var c=r.getTransferables;if(c===void 0&&(c=null),!e[o])try{f=f.map(function(l){return l&&l.isWorkerModule&&(t(l,function(v){if(v instanceof Error)throw v}),l=e[l.id].value),l}),n=a("<"+u+">.init",n),c&&(c=a("<"+u+">.getTransferables",c));var d=null;typeof n=="function"?d=n.apply(void 0,f):console.error("worker module init function failed to rehydrate"),e[o]={id:o,value:d,getTransferables:c},s(d)}catch(l){l&&l.noLog||console.error(l),s(l)}}function i(r,s){var o,u=r.id,f=r.args;(!e[u]||typeof e[u].value!="function")&&s(new Error("Worker module "+u+": not found or its 'init' did not return a function"));try{var n=(o=e[u]).value.apply(o,f);n&&typeof n.then=="function"?n.then(c,function(d){return s(d instanceof Error?d:new Error(""+d))}):c(n)}catch(d){s(d)}function c(d){try{var l=e[u].getTransferables&&e[u].getTransferables(d);(!l||!Array.isArray(l)||!l.length)&&(l=void 0),s(d,l)}catch(v){console.error(v),s(v)}}}function a(r,s){var o=void 0;self.troikaDefine=function(f){return o=f};var u=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+s+`
)`],{type:"application/javascript"}));try{importScripts(u)}catch(f){console.error(f)}return URL.revokeObjectURL(u),delete self.troikaDefine,o}self.addEventListener("message",function(r){var s=r.data,o=s.messageId,u=s.action,f=s.data;try{u==="registerModule"&&t(f,function(n){n instanceof Error?postMessage({messageId:o,success:!1,error:n.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof n=="function"}})}),u==="callModule"&&i(f,function(n,c){n instanceof Error?postMessage({messageId:o,success:!1,error:n.message}):postMessage({messageId:o,success:!0,result:n},c||void 0)})}catch(n){postMessage({messageId:o,success:!1,error:n.stack})}})}function te(e){var t=function(){for(var i=[],a=arguments.length;a--;)i[a]=arguments[a];return t._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,i);throw new Error("Worker module function was called but `init` did not return a callable function")})};return t._getInitResult=function(){var i=e.dependencies,a=e.init;i=Array.isArray(i)?i.map(function(s){return s&&s._getInitResult?s._getInitResult():s}):[];var r=Promise.all(i).then(function(s){return a.apply(null,s)});return t._getInitResult=function(){return r},r},t}var K=function(){var e=!1;if(typeof window<"u"&&typeof window.document<"u")try{var t=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));t.terminate(),e=!0}catch(i){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+i.message+"]")}return K=function(){return e},e},ne=0,re=0,O=!1,E=Object.create(null),k=Object.create(null),U=Object.create(null);function ie(e){if((!e||typeof e.init!="function")&&!O)throw new Error("requires `options.init` function");var t=e.dependencies,i=e.init,a=e.getTransferables,r=e.workerId;if(!K())return te(e);r==null&&(r="#default");var s="workerModule"+ ++ne,o=e.name||s,u=null;t=t&&t.map(function(n){return typeof n=="function"&&!n.workerModuleData&&(O=!0,n=ie({workerId:r,name:"<"+o+"> function dependency: "+n.name,init:`function(){return (
`+$(n)+`
)}`}),O=!1),n&&n.workerModuleData&&(n=n.workerModuleData),n});function f(){for(var n=[],c=arguments.length;c--;)n[c]=arguments[c];if(!u){u=S(r,"registerModule",f.workerModuleData);var d=function(){u=null,k[r].delete(d)};(k[r]||(k[r]=new Set)).add(d)}return u.then(function(l){var v=l.isCallable;if(v)return S(r,"callModule",{id:s,args:n});throw new Error("Worker module function was called but `init` did not return a callable function")})}return f.workerModuleData={isWorkerModule:!0,id:s,name:o,dependencies:t,init:$(i),getTransferables:a&&$(a)},f}function we(e){k[e]&&k[e].forEach(function(t){t()}),E[e]&&(E[e].terminate(),delete E[e])}function $(e){var t=e.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function oe(e){var t=E[e];if(!t){var i=$(ee);t=E[e]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+e.replace(/\*/g,"")+` **/

;(`+i+")()"],{type:"application/javascript"}))),t.onmessage=function(a){var r=a.data,s=r.messageId,o=U[s];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete U[s],o(r)}}return t}function S(e,t,i){return new Promise(function(a,r){var s=++re;U[s]=function(o){o.success?a(o.result):r(new Error("Error in worker "+t+" call: "+o.error))},oe(e).postMessage({messageId:s,action:t,data:i})})}const se=/\bvoid\s+main\s*\(\s*\)\s*{/g;function R(e){const t=/^[ \t]*#include +<([\w\d./]+)>/gm;function i(a,r){let s=Q[r];return s?R(s):a}return e.replace(t,i)}const m=[];for(let e=0;e<256;e++)m[e]=(e<16?"0":"")+e.toString(16);function ae(){const e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,a=Math.random()*4294967295|0;return(m[e&255]+m[e>>8&255]+m[e>>16&255]+m[e>>24&255]+"-"+m[t&255]+m[t>>8&255]+"-"+m[t>>16&15|64]+m[t>>24&255]+"-"+m[i&63|128]+m[i>>8&255]+"-"+m[i>>16&255]+m[i>>24&255]+m[a&255]+m[a>>8&255]+m[a>>16&255]+m[a>>24&255]).toUpperCase()}const x=Object.assign||function(){let e=arguments[0];for(let t=1,i=arguments.length;t<i;t++){let a=arguments[t];if(a)for(let r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},ue=Date.now(),W=new WeakMap,L=new Map;let ce=1e10;function H(e,t){const i=ge(t);let a=W.get(e);if(a||W.set(e,a=Object.create(null)),a[i])return new a[i];const r=`_onBeforeCompile${i}`,s=function(n,c){e.onBeforeCompile.call(this,n,c);const d=this.customProgramCacheKey()+"|"+n.vertexShader+"|"+n.fragmentShader;let l=L[d];if(!l){const v=fe(this,n,t,i);l=L[d]=v}n.vertexShader=l.vertexShader,n.fragmentShader=l.fragmentShader,x(n.uniforms,this.uniforms),t.timeUniform&&(n.uniforms[t.timeUniform]={get value(){return Date.now()-ue}}),this[r]&&this[r](n)},o=function(){return u(t.chained?e:e.clone())},u=function(n){const c=Object.create(n,f);return Object.defineProperty(c,"baseMaterial",{value:e}),Object.defineProperty(c,"id",{value:ce++}),c.uuid=ae(),c.uniforms=x({},n.uniforms,t.uniforms),c.defines=x({},n.defines,t.defines),c.defines[`TROIKA_DERIVED_MATERIAL_${i}`]="",c.extensions=x({},n.extensions,t.extensions),c._listeners=void 0,c},f={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return e.customProgramCacheKey()+"|"+i}},onBeforeCompile:{get(){return s},set(n){this[r]=n}},copy:{writable:!0,configurable:!0,value:function(n){return e.copy.call(this,n),!e.isShaderMaterial&&!e.isDerivedMaterial&&(x(this.extensions,n.extensions),x(this.defines,n.defines),x(this.uniforms,q.clone(n.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const n=new e.constructor;return u(n).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let n=this._depthMaterial;return n||(n=this._depthMaterial=H(e.isDerivedMaterial?e.getDepthMaterial():new J({depthPacking:Y}),t),n.defines.IS_DEPTH_MATERIAL="",n.uniforms=this.uniforms),n}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let n=this._distanceMaterial;return n||(n=this._distanceMaterial=H(e.isDerivedMaterial?e.getDistanceMaterial():new Z,t),n.defines.IS_DISTANCE_MATERIAL="",n.uniforms=this.uniforms),n}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:n,_distanceMaterial:c}=this;n&&n.dispose(),c&&c.dispose(),e.dispose.call(this)}}};return a[i]=o,new o}function fe(e,{vertexShader:t,fragmentShader:i},a,r){let{vertexDefs:s,vertexMainIntro:o,vertexMainOutro:u,vertexTransform:f,fragmentDefs:n,fragmentMainIntro:c,fragmentMainOutro:d,fragmentColorTransform:l,customRewriter:v,timeUniform:T}=a;if(s=s||"",o=o||"",u=u||"",n=n||"",c=c||"",d=d||"",(f||v)&&(t=R(t)),(l||v)&&(i=i.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),i=R(i)),v){let g=v({vertexShader:t,fragmentShader:i});t=g.vertexShader,i=g.fragmentShader}if(l){let g=[];i=i.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,w=>(g.push(w),"")),d=`${l}
${g.join(`
`)}
${d}`}if(T){const g=`
uniform float ${T};
`;s=g+s,n=g+n}return f&&(t=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${t}
`,s=`${s}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${f}
}
`,o=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${o}
`,t=t.replace(/\b(position|normal|uv)\b/g,(g,w,p,h)=>/\battribute\s+vec[23]\s+$/.test(h.substr(0,p))?w:`troika_${w}_${r}`),e.map&&e.map.channel>0||(t=t.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),t=N(t,r,s,o,u),i=N(i,r,n,c,d),{vertexShader:t,fragmentShader:i}}function N(e,t,i,a,r){return(a||r||i)&&(e=e.replace(se,`
${i}
void troikaOrigMain${t}() {`),e+=`
void main() {
  ${a}
  troikaOrigMain${t}();
  ${r}
}`),e}function le(e,t){return e==="uniforms"?void 0:typeof t=="function"?t.toString():t}let de=0;const G=new Map;function ge(e){const t=JSON.stringify(e,le);let i=G.get(t);return i==null&&G.set(t,i=++de),i}function be(){return navigator.languages!=null?navigator.languages[0]:navigator.language}const Me={onPointerEnter:()=>{document.body.style.cursor="pointer"},onPointerLeave:()=>{document.body.style.cursor="default"}},_e=()=>!0;export{we as a,_e as b,H as c,ie as d,be as g,me as i,ve as m,Me as p,he as t,se as v};
//# sourceMappingURL=utils-DNdCMZ6f.js.map
